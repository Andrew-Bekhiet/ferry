(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{66:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return o})),t.d(a,"metadata",(function(){return l})),t.d(a,"rightToc",(function(){return c})),t.d(a,"default",(function(){return b}));var n=t(2),r=t(6),i=(t(0),t(86)),o={id:"codegen",title:"Generate GraphQL Classes",sidebar_label:"Generate Classes"},l={unversionedId:"codegen",id:"codegen",isDocsHomePage:!1,title:"Generate GraphQL Classes",description:"Ferry generates immutable data classes for all of your GraphQL Operations and Fragments. This saves time, improves the developer experience, and eliminates potential runtime errors.",source:"@site/../docs/codegen.md",slug:"/codegen",permalink:"/docs/codegen",editUrl:"https://github.com/gql-dart/ferry/edit/master/docs/../docs/codegen.md",version:"current",sidebar_label:"Generate Classes",sidebar:"mainSidebar",previous:{title:"Setup",permalink:"/docs/setup"},next:{title:"Queries",permalink:"/docs/queries"}},c=[{value:"How it works",id:"how-it-works",children:[]},{value:"Download Your GraphQL Schema",id:"download-your-graphql-schema",children:[]},{value:"Create <code>.graphql</code> Files",id:"create-graphql-files",children:[{value:"Importing from other <code>.graphql</code> files",id:"importing-from-other-graphql-files",children:[]}]},{value:"Build Generated Classes",id:"build-generated-classes",children:[]}],s={rightToc:c};function b(e){var a=e.components,t=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},s,t,{components:a,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Ferry generates immutable data classes for all of your GraphQL Operations and Fragments. This saves time, improves the developer experience, and eliminates potential runtime errors."),Object(i.b)("h2",{id:"how-it-works"},"How it works"),Object(i.b)("p",null,"Let's say I've created an ",Object(i.b)("inlineCode",{parentName:"p"},"all_pokemon.graphql")," file with the following query:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-graphql"}),"query AllPokemon($first: Int!) {\n  pokemons(first: $first) {\n    id\n    name\n    maxHP\n    image\n  }\n}\n")),Object(i.b)("p",null,"When I run the generator, Ferry will create the following classes:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"GAllPokemonReq"),": This class extends ",Object(i.b)("inlineCode",{parentName:"li"},"OperationRequest")," and includes the GraphQL document and variables for this query. It also includes other necessary configuration to adjust how this operation is executed (e.g. ",Object(i.b)("inlineCode",{parentName:"li"},"FetchPolicy"),")."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"GAllPokemonVars"),': This class includes any variables used in the query (just "first", in this case)'),Object(i.b)("li",{parentName:"ol"},Object(i.b)("inlineCode",{parentName:"li"},"GAllPokemonData"),': This class represents the data returned by the query, including the "pokemons" field and all child fields.')),Object(i.b)("p",null,"In addition, Ferry will generate any necessary supporting classes from your GraphQL schema, including ",Object(i.b)("inlineCode",{parentName:"p"},"input")," types, ",Object(i.b)("inlineCode",{parentName:"p"},"enum"),"s, and custom ",Object(i.b)("inlineCode",{parentName:"p"},"scalars"),"."),Object(i.b)("div",{className:"admonition admonition-important alert alert--info"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"important")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Ferry's generated classes are based on the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://pub.dev/packages/built_value"}),"built_value")," package, which means they are:"),Object(i.b)("ol",{parentName:"div"},Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"immutable"),": once they are created, they cannot be changed."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"equatable"),": multiple instances with identical values have ",Object(i.b)("inlineCode",{parentName:"li"},"==")," equality."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"serializable"),": can be serialized using the ",Object(i.b)("inlineCode",{parentName:"li"},"toJson()")," and ",Object(i.b)("inlineCode",{parentName:"li"},"fromJson()")," methods."),Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"use the builder pattern"),": can be deeply copied with modifications using the Builder Pattern.")),Object(i.b)("p",{parentName:"div"},"Check out ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://medium.com/dartlang/darts-built-value-for-immutable-object-models-83e2497922d4"}),"this post")," for more information on ",Object(i.b)("inlineCode",{parentName:"p"},"built_value")," classes and how to use them."))),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"As you can see, Ferry prepends ",Object(i.b)("inlineCode",{parentName:"p"},'"G"')," to all class names. This is due to a limitation in the ",Object(i.b)("inlineCode",{parentName:"p"},"built_value")," package and is necessary to ensure classes get generated correctly."))),Object(i.b)("h2",{id:"download-your-graphql-schema"},"Download Your GraphQL Schema"),Object(i.b)("p",null,"To generate our classes, we first need to download our GraphQL in SDL format to any location within the ",Object(i.b)("inlineCode",{parentName:"p"},"lib")," project directory. You can use the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/prisma-labs/get-graphql-schema"}),"get-graphql-schema")," tool to download a schema from a GraphQL endpoint:"),Object(i.b)("p",null,"First, install the tool:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"npm install -g get-graphql-schema\n")),Object(i.b)("p",null,"Next, download the schema by running the following command, replacing ",Object(i.b)("inlineCode",{parentName:"p"},"[ENDPOINT_URL]")," with the url of your GraphQL endpoint:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"get-graphql-schema [ENDPOINT_URL] > lib/schema.graphql\n")),Object(i.b)("h2",{id:"create-graphql-files"},"Create ",Object(i.b)("inlineCode",{parentName:"h2"},".graphql")," Files"),Object(i.b)("p",null,"As shown in the example above, we need to save all of our GraphQL operations to files that end with the ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," extension."),Object(i.b)("p",null,"The generated files are created as siblings to the ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," file. To reduce clutter, we recommend placing your ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," files in a ",Object(i.b)("inlineCode",{parentName:"p"},"/graphql")," subdirectory. For example, if I have an ",Object(i.b)("inlineCode",{parentName:"p"},"AllPokemon")," widget that will use the ",Object(i.b)("inlineCode",{parentName:"p"},"AllPokemon")," query from above, I might use the following directory structure:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"lib/\n  src/\n    components/\n      graphql/\n        ### Generated files will go here\n        all_pokemon.graphql\n      all_pokemon.dart\n")),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Make sure that all ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," files are located in the ",Object(i.b)("inlineCode",{parentName:"p"},"lib")," directory (or a subdirectory). The generator cannot read files located outside of ",Object(i.b)("inlineCode",{parentName:"p"},"lib"),"."))),Object(i.b)("p",null,"See the ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/gql-dart/ferry/tree/master/examples"}),"examples")," for more detail."),Object(i.b)("h3",{id:"importing-from-other-graphql-files"},"Importing from other ",Object(i.b)("inlineCode",{parentName:"h3"},".graphql")," files"),Object(i.b)("p",null,"If your operations have dependencies in other ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," files, you can import them by adding a ",Object(i.b)("em",{parentName:"p"},"comment import")," statement at the top of your ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," file."),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-graphql"}),"# import './pokemon_card_fragment.graphql'\n")),Object(i.b)("h2",{id:"build-generated-classes"},"Build Generated Classes"),Object(i.b)("p",null,"Now that we've ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/codegen#download-your-graphql-schema"}),"downloaded our GraphQL schema")," and ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/codegen#create-graphql-files"}),"saved our GraphQL Operations")," to ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," files, we're almost ready to run the generator. The final step is to add a configuration file so that ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://pub.dev/packages/build_runner"}),"build_runner")," knows which generators to run and where to find our schema."),Object(i.b)("p",null,"Add a ",Object(i.b)("inlineCode",{parentName:"p"},"build.yaml")," file to your project root with the following contents, ",Object(i.b)("strong",{parentName:"p"},"replacing ",Object(i.b)("inlineCode",{parentName:"strong"},"your_package_name")," and the path to your schema file")," accordingly."),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml"}),"targets:\n  $default:\n    builders:\n      ferry_generator|graphql_builder:\n        enabled: true\n        options:\n          schema: your_package_name|lib/schema.graphql\n      ferry_generator|serializer_builder:\n        enabled: true\n        options:\n          schema: your_package_name|lib/schema.graphql\n\n")),Object(i.b)("p",null,"Note: By default, generated files are put into a directory called ",Object(i.b)("inlineCode",{parentName:"p"},"__generated__"),".\nIf you like to rename this directory, pass "),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml"}),"output_dir: '<your desired name>'\n")),Object(i.b)("p",null,"to options.\nIf you like to omit this directory at all and generate the code next to the .graphql files (this was the default behavior before release 0.11.0) ),\nuse "),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-yaml"}),"output_dir: ''\n")),Object(i.b)("p",null,"Now you can build your dart generated files by calling:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"dart run build_runner build\n")),Object(i.b)("p",null,"Or, if you are using flutter"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"flutter pub run build_runner build\n")),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"You may need to add the ",Object(i.b)("inlineCode",{parentName:"p"},"--delete-conflicting-outputs")," flag to the build_runner command:"),Object(i.b)("pre",{parentName:"div"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"dart run build_runner build --delete-conflicting-outputs\n")))),Object(i.b)("p",null,"After running the generator, your directory should look something like this:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"lib/\n  src/\n    components/\n      graphql/\n        __generated__\n          all_pokemon.graphql\n          all_pokemon.ast.gql.dart # generated\n          all_pokemon.data.gql.dart # generated\n          all_pokemon.data.gql.g.dart # generated\n          all_pokemon.req.gql.dart # generated\n          all_pokemon.req.gql.g.dart # generated\n          all_pokemon.var.gql.dart # generated\n          all_pokemon.var.gql.g.dart # generated\n      all_pokemon.dart\n")),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"You may want to configure your IDE to hide the generated files, since it can get unwieldy, even if you're placing your ",Object(i.b)("inlineCode",{parentName:"p"},".graphql")," files in a subdirectory."),Object(i.b)("p",{parentName:"div"},"If you use VSCode, you can include the following in your ",Object(i.b)("inlineCode",{parentName:"p"},"/.vscode/settings.json")," file:"),Object(i.b)("pre",{parentName:"div"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),'{\n  "files.exclude": {\n    "**/*.ast.gql.dart": true,\n    "**/*.req.gql.dart": true,\n    "**/*.data.gql.dart": true,\n    "**/*.var.gql.dart": true,\n    "**/*.gql.g.dart": true\n  }\n}\n')))))}b.isMDXComponent=!0},86:function(e,a,t){"use strict";t.d(a,"a",(function(){return p})),t.d(a,"b",(function(){return u}));var n=t(0),r=t.n(n);function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){i(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function c(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=r.a.createContext({}),b=function(e){var a=r.a.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},p=function(e){var a=b(e.components);return r.a.createElement(s.Provider,{value:a},e.children)},d={inlineCode:"code",wrapper:function(e){var a=e.children;return r.a.createElement(r.a.Fragment,{},a)}},m=r.a.forwardRef((function(e,a){var t=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),p=b(t),m=n,u=p["".concat(o,".").concat(m)]||p[m]||d[m]||i;return t?r.a.createElement(u,l(l({ref:a},s),{},{components:t})):r.a.createElement(u,l({ref:a},s))}));function u(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var i=t.length,o=new Array(i);o[0]=m;var l={};for(var c in a)hasOwnProperty.call(a,c)&&(l[c]=a[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var s=2;s<i;s++)o[s]=t[s];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"}}]);